
# 微信机器人使用说明（进退群配置版）

### **版本要求**：仅适用于 `wa1122` 以上版本
- **若有疑问请联系我** **联系方式TG:@ljh8686**
## 📋 功能概述

这是一个微信机器人脚本，用于在群成员加入或退出时自动发送欢迎/告别消息，支持多种消息类型和媒体文件发送。新版将所有设置功能整合到一个统一的配置界面。

## 🚀 主要功能

### 1. 消息类型支持
- **文本消息**：可自定义欢迎/告别文本内容
- **卡片消息**：图文并茂的卡片式提示
- **多媒体支持**：
  - 图片
  - 语音
  - 表情包
  - 视频
  - 文件分享

### 2. 高级特性
- **可配置延迟**：整体延迟 + 精细化媒体延迟控制
- **发送顺序控制**：媒体文件可在提示语前或后发送
- **个性化变量**：支持昵称、WXID、群名、时间等变量替换
- **群组独立设置**：每个群可以单独开关进群/退群提示
- **随机提示语库**：内置丰富的随机欢迎/告别语模板
- **文件多选支持**：可同时选择多个媒体文件

## ⚙️ 配置方法

### 统一设置入口
发送内容：**进退群设置**

点击发送键后打开统一的设置界面，包含所有配置选项。

## 🔧 详细配置说明

### 统一设置界面结构

设置界面分为多个配置卡片：

#### 1. ⚙️ 主要功能管理
- **管理监听群组和进退群开关**：进入群组管理界面

#### 2. 🚀 核心设置
- **触发后整体延迟（秒）**：0-600秒，事件触发到开始执行的延迟时间
- **选择提示语类型**：文本或卡片消息

#### 3. 📝 文本提示语设置
- **进群欢迎语**：自定义欢迎消息模板
- **退群通知**：自定义告别消息模板
- **💡 随机填充**：一键生成随机提示语
- **🔄 恢复默认**：恢复文本提示语默认设置

#### 4. 🖼️ 卡片提示语设置
- **进群卡片标题/描述**：设置卡片内容
- **退群卡片标题/描述**：设置告别卡片
- **💡 随机填充**：一键生成随机卡片内容
- **🔄 恢复默认**：恢复卡片提示语默认设置

#### 5. 📂 附加媒体设置（通用）
- **媒体发送顺序**：如 image,voice,emoji,video,file
- **发送时机**：不发送、先媒体后提示、先提示后媒体
- **🗂️ 媒体文件选择**：支持多选的各类媒体文件

#### 6. ⏱️ 精细延迟设置（毫秒）
- 提示语、图片、语音、表情、视频、文件的独立延迟设置

### 群组管理功能

在"主要功能管理"中点击按钮进入群组管理界面：

#### 群聊列表管理
- **搜索功能**：快速查找特定群聊
- **勾选监听**：选择需要监听的群聊
- **✨ 全选/取消全选**：批量操作群聊选择
- **长按群聊**：进入单个群聊的详细设置

#### 单个群聊设置
- **开启进群提示**：控制该群的欢迎消息开关
- **开启退群提示**：控制该群的告别消息开关

### 媒体文件选择

支持多选的文件浏览器：
- 点击各类媒体选择按钮进入文件浏览器
- 支持上一级目录导航
- 可多选文件并显示已选数量
- 自动记忆上次浏览的目录

**媒体类型支持**：
- **图片**：.png等格式
- **语音**：无特定格式限制
- **表情**：.png等格式
- **视频**：.mp4等格式
- **文件**：任意格式文件分享

## 🔤 可用变量

在提示语中使用以下变量进行个性化替换：

| 变量 | 说明 | 示例 |
|------|------|------|
| `%userName%` | 进群/退群用户昵称（优先显示群备注） | 张三 |
| `%userWxid%` | 进群/退群用户WXID | wxid_123456 |
| `%groupName%` | 群聊名称 | 技术交流群 |
| `%time%` | 当前时间 | 2024-01-01 12:00:00 |
| `[AtWx=%userWxid%]` | @提及用户 | @张三 |

> **特别说明**：退群消息中，`%userName%` 会同时显示昵称和群备注（格式：群备注 (昵称)）

## 💡 使用示例

### 文本提示语示例
```

[AtWx=%userWxid%] 🎉欢迎 %userName% 加入群聊！ 
⏰时间：%time%
🏠群聊：%groupName%
🆔ID：%userWxid%

```

### 卡片提示语示例
- **标题**：🎊 欢迎：%userName%
- **描述**：🆔：%userWxid%\n⏰：%time%\n🏠：%groupName%

### 随机提示语示例

**进群随机语**：
- "[AtWx=%userWxid%] 欢迎 %userName% 加入 %groupName%～ 🎉"
- "热烈欢迎新朋友 %userName%，大家请多关照！"
- "又来了一位大佬，欢迎 %userName%！记得看群公告哦~"

**退群随机语**：
- "有缘再会，祝 %userName% 前程似锦。"
- "悄悄地他走了，正如他悄悄地来。再见，%userName%。"



## ⚠️ 注意事项

1. **权限要求**：确保机器人有相应的群聊访问和消息发送权限
2. **文件路径**：指定的媒体文件必须存在且可访问
3. **变量格式**：变量名称区分大小写，请严格按照格式使用
4. **延迟设置**：整体延迟和精细化延迟会叠加计算
5. **群聊选择**：只有被选中的群聊才会触发自动提示
6. **发送顺序**：媒体发送顺序按照设置的顺序执行

## 🔄 恢复默认设置

- **单个卡片恢复**：每个设置卡片都有独立的恢复按钮
- **全局恢复**：底部的"🔄 恢复默认"按钮可一键恢复所有设置

## 🆘 常见问题

**Q: 发送"进退群设置"后没有反应？**  
A: 检查机器人是否正常运行，是否有相应的消息处理权限

**Q: 提示语没有发送？**  
A: 确认群聊已选中，且该群的提示开关已开启

**Q: 媒体文件发送失败？**  
A: 检查文件路径是否正确，文件是否存在且可读

**Q: @功能不生效？**  
A: 确保使用了正确的变量格式 `[AtWx=%userWxid%]`

**Q: 延迟效果不明显？**  
A: 整体延迟是首要延迟，精细化延迟是后续动作间隔，两者叠加生效

**Q: 如何批量选择群聊？**  
A: 使用群组管理界面的"✨ 全选"功能可快速选择所有群聊

**Q: 随机填充的提示语可以编辑吗？**  
A: 可以，随机填充后会直接显示在编辑框中，可进一步自定义修改
- **若有疑问请联系我** **联系方式TG:@ljh8686**